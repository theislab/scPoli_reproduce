/home/icb/carlo.dedonno/anaconda3/envs/lataq/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))

/home/icb/carlo.dedonno/anaconda3/envs/lataq/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))

/home/icb/carlo.dedonno/anaconda3/envs/lataq/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))

WARNING: Youâ€™re trying to run this on 89 dimensions of `.X`, if you really want this, set `use_rep='X'`.
         Falling back to preprocessing with `sc.pp.pca` and default params.
job exception: Dimension out of range (expected to be in range of [-1, 0], but got 1)

Traceback (most recent call last):
  File "/storage/groups/ml01/workspace/carlo.dedonno/lataq_reproduce/hyperopt/tranvae_hyperparam_search.py", line 148, in <module>
    best = fmin(
  File "/home/icb/carlo.dedonno/anaconda3/envs/lataq/lib/python3.8/site-packages/hyperopt/fmin.py", line 507, in fmin
    return trials.fmin(
  File "/home/icb/carlo.dedonno/anaconda3/envs/lataq/lib/python3.8/site-packages/hyperopt/base.py", line 682, in fmin
    return fmin(
  File "/home/icb/carlo.dedonno/anaconda3/envs/lataq/lib/python3.8/site-packages/hyperopt/fmin.py", line 553, in fmin
    rval.exhaust()
  File "/home/icb/carlo.dedonno/anaconda3/envs/lataq/lib/python3.8/site-packages/hyperopt/fmin.py", line 356, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "/home/icb/carlo.dedonno/anaconda3/envs/lataq/lib/python3.8/site-packages/hyperopt/fmin.py", line 292, in run
    self.serial_evaluate()
  File "/home/icb/carlo.dedonno/anaconda3/envs/lataq/lib/python3.8/site-packages/hyperopt/fmin.py", line 170, in serial_evaluate
    result = self.domain.evaluate(spec, ctrl)
  File "/home/icb/carlo.dedonno/anaconda3/envs/lataq/lib/python3.8/site-packages/hyperopt/base.py", line 907, in evaluate
    rval = self.fn(pyll_rval)
  File "/storage/groups/ml01/workspace/carlo.dedonno/lataq_reproduce/hyperopt/tranvae_hyperparam_search.py", line 116, in objective
    tranvae_query.train(
  File "/storage/groups/ml01/workspace/carlo.dedonno/LATAQ/lataq/models/lataq_model.py", line 158, in train
    self.trainer.train(n_epochs, lr, eps)
  File "/home/icb/carlo.dedonno/anaconda3/envs/lataq/lib/python3.8/site-packages/scArches-0.3.5-py3.8.egg/scarches/trainers/trvae/trainer.py", line 218, in train
    self.on_epoch_begin(lr, eps)
  File "/storage/groups/ml01/workspace/carlo.dedonno/LATAQ/lataq/trainers/lataq.py", line 237, in on_epoch_begin
    self.initialize_landmarks()
  File "/storage/groups/ml01/workspace/carlo.dedonno/LATAQ/lataq/trainers/lataq.py", line 225, in initialize_landmarks
    dists = euclidean_dist(latent, torch.stack(self.landmarks_unlabeled).squeeze())
  File "/storage/groups/ml01/workspace/carlo.dedonno/LATAQ/lataq/trainers/_utils.py", line 68, in euclidean_dist
    if d != y.size(1):
IndexError: Dimension out of range (expected to be in range of [-1, 0], but got 1)
