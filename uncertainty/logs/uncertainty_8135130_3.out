Starting job 8135134
SLURM assigned me the node(s): supergpu05
Experiments are running under the following process IDs:
Experiment ID: 4	Process ID: 97734

During startup - Warning messages:
1: package ‘methods’ was built under R version 3.6.3 
2: package ‘datasets’ was built under R version 3.6.3 
3: package ‘utils’ was built under R version 3.6.3 
4: package ‘grDevices’ was built under R version 3.6.3 
5: package ‘graphics’ was built under R version 3.6.3 
6: package ‘stats’ was built under R version 3.6.3 
2022-05-19 13:55:08 (INFO): Running command 'run'
2022-05-19 13:55:08 (INFO): Started run with ID "4"
2022-05-19 13:55:09 (INFO): Data loaded succesfully
2022-05-19 13:55:09 (INFO): Model instantiated
Embedding dictionary:
 	Num conditions: 3
 	Embedding dim: 10
Encoder Architecture:
	Input Layer in, out and cond: 4000 128 0
	Hidden Layer 1 in/out: 128 128
	Hidden Layer 2 in/out: 128 128
	Mean/Var Layer in/out: 128 25
Decoder Architecture:
	First Layer in, out and cond:  25 128 10
	Hidden Layer 1 in/out: 128 128
	Hidden Layer 2 in/out: 128 128
	Output Layer in/out:  128 4000 

loaders init
loaders init done
0.5584971904754639
 |--------------------| 1.0%  - val_loss: 1462.2074924045 - val_trvae_loss: 1462.2074924045 |--------------------| 2.0%  - val_loss: 1429.9783732096 - val_trvae_loss: 1429.9783732096 |--------------------| 3.0%  - val_loss: 1411.0946316189 - val_trvae_loss: 1411.0946316189 |--------------------| 4.0%  - val_loss: 1399.4896986220 - val_trvae_loss: 1399.4896986220 |█-------------------| 5.0%  - val_loss: 1392.6665242513 - val_trvae_loss: 1392.6665242513 |█-------------------| 6.0%  - val_loss: 1387.3534749349 - val_trvae_loss: 1387.3534749349 |█-------------------| 7.0%  - val_loss: 1382.3945922852 - val_trvae_loss: 1382.3945922852 |█-------------------| 8.0%  - val_loss: 1377.9040866428 - val_trvae_loss: 1377.9040866428 |█-------------------| 9.0%  - val_loss: 1375.4914550781 - val_trvae_loss: 1375.4914550781 |██------------------| 10.0%  - val_loss: 1372.6102634006 - val_trvae_loss: 1372.6102634006 |██------------------| 11.0%  - val_loss: 1369.4530504015 - val_trvae_loss: 1369.4530504015 |██------------------| 12.0%  - val_loss: 1367.7824774848 - val_trvae_loss: 1367.7824774848 |██------------------| 13.0%  - val_loss: 1366.2802327474 - val_trvae_loss: 1366.2802327474 |██------------------| 14.0%  - val_loss: 1363.5224880642 - val_trvae_loss: 1363.5224880642 |███-----------------| 15.0%  - val_loss: 1363.8363783095 - val_trvae_loss: 1363.8363783095 |███-----------------| 16.0%  - val_loss: 1361.8089735243 - val_trvae_loss: 1361.8089735243 |███-----------------| 17.0%  - val_loss: 1360.8216756185 - val_trvae_loss: 1360.8216756185 |███-----------------| 18.0%  - val_loss: 1361.6768731011 - val_trvae_loss: 1361.6768731011 |███-----------------| 19.0%  - val_loss: 1362.1473727756 - val_trvae_loss: 1362.1473727756 |████----------------| 20.0%  - val_loss: 1360.6392483181 - val_trvae_loss: 1360.6392483181 |████----------------| 21.0%  - val_loss: 1359.9718763563 - val_trvae_loss: 1359.9718763563 |████----------------| 22.0%  - val_loss: 1360.7904256185 - val_trvae_loss: 1360.7904256185 |████----------------| 23.0%  - val_loss: 1357.7764689128 - val_trvae_loss: 1357.7764689128 |████----------------| 24.0%  - val_loss: 1357.8994886610 - val_trvae_loss: 1357.8994886610 |█████---------------| 25.0%  - val_loss: 1357.1423136393 - val_trvae_loss: 1357.1423136393 |█████---------------| 26.0%  - val_loss: 1355.7932671441 - val_trvae_loss: 1355.7932671441 |█████---------------| 27.0%  - val_loss: 1357.2992689345 - val_trvae_loss: 1357.2992689345 |█████---------------| 28.0%  - val_loss: 1358.1387939453 - val_trvae_loss: 1358.1387939453 |█████---------------| 29.0%  - val_loss: 1355.3648410373 - val_trvae_loss: 1355.3648410373 |██████--------------| 30.0%  - val_loss: 1356.5097995334 - val_trvae_loss: 1356.5097995334 |██████--------------| 31.0%  - val_loss: 1356.5619845920 - val_trvae_loss: 1356.5619845920 |██████--------------| 32.0%  - val_loss: 1356.2758856879 - val_trvae_loss: 1356.2758856879 |██████--------------| 33.0%  - val_loss: 1356.3963012695 - val_trvae_loss: 1356.3963012695 |██████--------------| 34.0%  - val_loss: 1354.7785034180 - val_trvae_loss: 1354.7785034180 |███████-------------| 35.0%  - val_loss: 1354.1594373915 - val_trvae_loss: 1354.1594373915 |███████-------------| 36.0%  - val_loss: 1354.6249389648 - val_trvae_loss: 1354.6249389648 |███████-------------| 37.0%  - val_loss: 1354.9163886176 - val_trvae_loss: 1354.9163886176 |███████-------------| 38.0%  - val_loss: 1354.5727403429 - val_trvae_loss: 1354.5727403429 |███████-------------| 39.0%  - val_loss: 1354.5088772244 - val_trvae_loss: 1354.5088772244 |████████------------| 40.0%  - val_loss: 1354.1293199327 - val_trvae_loss: 1354.1293199327 |████████------------| 41.0%  - val_loss: 1353.3033040365 - val_trvae_loss: 1353.3033040365 |████████------------| 42.0%  - val_loss: 1356.3176133898 - val_trvae_loss: 1356.3176133898 |████████------------| 43.0%  - val_loss: 1354.0368584527 - val_trvae_loss: 1354.0368584527 |████████------------| 44.0%  - val_loss: 1354.1729329427 - val_trvae_loss: 1354.1729329427 |█████████-----------| 45.0%  - val_loss: 1353.7685072157 - val_trvae_loss: 1353.7685072157 |█████████-----------| 46.0%  - val_loss: 1354.1960449219 - val_trvae_loss: 1354.1960449219 |█████████-----------| 47.0%  - val_loss: 1353.1222127279 - val_trvae_loss: 1353.1222127279 |█████████-----------| 48.0%  - val_loss: 1354.8102620443 - val_trvae_loss: 1354.8102620443 |█████████-----------| 49.0%  - val_loss: 1353.9807400174 - val_trvae_loss: 1353.9807400174 |██████████----------| 50.0%  - val_loss: 1352.1527099609 - val_trvae_loss: 1352.1527099609 |██████████----------| 51.0%  - val_loss: 1356.0332980686 - val_trvae_loss: 1356.0332980686 |██████████----------| 52.0%  - val_loss: 1353.8401285807 - val_trvae_loss: 1353.8401285807 |██████████----------| 53.0%  - val_loss: 1354.1415473090 - val_trvae_loss: 1354.1415473090 |██████████----------| 54.0%  - val_loss: 1353.4904174805 - val_trvae_loss: 1353.4904174805 |███████████---------| 55.0%  - val_loss: 1353.2706163194 - val_trvae_loss: 1353.2706163194 |███████████---------| 56.0%  - val_loss: 1353.7732272678 - val_trvae_loss: 1353.7732272678 |███████████---------| 57.0%  - val_loss: 1354.2394205729 - val_trvae_loss: 1354.2394205729 |███████████---------| 58.0%  - val_loss: 1352.2924669054 - val_trvae_loss: 1352.2924669054 |███████████---------| 59.0%  - val_loss: 1353.8228827582 - val_trvae_loss: 1353.8228827582 |████████████--------| 60.0%  - val_loss: 1353.2858276367 - val_trvae_loss: 1353.2858276367 |████████████--------| 61.0%  - val_loss: 1352.7749362522 - val_trvae_loss: 1352.7749362522 |████████████--------| 62.0%  - val_loss: 1353.7132093641 - val_trvae_loss: 1353.7132093641 |████████████--------| 63.0%  - val_loss: 1351.6404012044 - val_trvae_loss: 1351.6404012044 |████████████--------| 64.0%  - val_loss: 1353.5930311415 - val_trvae_loss: 1353.5930311415 |█████████████-------| 65.0%  - val_loss: 1352.0383504232 - val_trvae_loss: 1352.0383504232 |█████████████-------| 66.0%  - val_loss: 1352.1233113607 - val_trvae_loss: 1352.1233113607 |█████████████-------| 67.0%  - val_loss: 1352.2630208333 - val_trvae_loss: 1352.2630208333 |█████████████-------| 68.0%  - val_loss: 1352.3669704861 - val_trvae_loss: 1352.3669704861 |█████████████-------| 69.0%  - val_loss: 1353.1212090386 - val_trvae_loss: 1353.1212090386 |██████████████------| 70.0%  - val_loss: 1352.9286499023 - val_trvae_loss: 1352.9286499023 |██████████████------| 71.0%  - val_loss: 1353.7864040799 - val_trvae_loss: 1353.7864040799 |██████████████------| 72.0%  - val_loss: 1353.1617092556 - val_trvae_loss: 1353.1617092556 |██████████████------| 73.0%  - val_loss: 1352.6760796441 - val_trvae_loss: 1352.6760796441 |██████████████------| 74.0%  - val_loss: 1351.5219930013 - val_trvae_loss: 1351.5219930013 |███████████████-----| 75.0%  - val_loss: 1352.6875813802 - val_trvae_loss: 1352.6875813802 |███████████████-----| 76.0%  - val_loss: 1352.7773437500 - val_trvae_loss: 1352.7773437500 |███████████████-----| 77.0%  - val_loss: 1352.0547620985 - val_trvae_loss: 1352.0547620985 |███████████████-----| 78.0%  - val_loss: 1352.9136895074 - val_trvae_loss: 1352.9136895074 |███████████████-----| 79.0%  - val_loss: 1353.1399671766 - val_trvae_loss: 1353.1399671766 |████████████████----| 80.0%  - val_loss: 1351.2988688151 - val_trvae_loss: 1351.2988688151 |████████████████----| 81.0%  - val_loss: 1363.9155273438 - val_trvae_loss: 1356.0293443468 - val_landmark_loss: 7.8861750232 - val_labeled_loss: 7.8861750232 |████████████████----| 82.0%  - val_loss: 1365.3889838325 - val_trvae_loss: 1359.6007486979 - val_landmark_loss: 5.7882213195 - val_labeled_loss: 5.7882213195 |████████████████----| 83.0%  - val_loss: 1359.8261311849 - val_trvae_loss: 1354.3870578342 - val_landmark_loss: 5.4390662909 - val_labeled_loss: 5.4390662909 |████████████████----| 84.0%  - val_loss: 1358.5464409722 - val_trvae_loss: 1354.1378377279 - val_landmark_loss: 4.4085938136 - val_labeled_loss: 4.4085938136 |█████████████████---| 85.0%  - val_loss: 1360.7952813043 - val_trvae_loss: 1356.5260823568 - val_landmark_loss: 4.2692075570 - val_labeled_loss: 4.2692075570 |█████████████████---| 86.0%  - val_loss: 1357.0788506402 - val_trvae_loss: 1353.3309529622 - val_landmark_loss: 3.7479119632 - val_labeled_loss: 3.7479119632 |█████████████████---| 87.0%  - val_loss: 1357.6736585829 - val_trvae_loss: 1353.9281955295 - val_landmark_loss: 3.7454723583 - val_labeled_loss: 3.7454723583 |█████████████████---| 88.0%  - val_loss: 1357.3238457574 - val_trvae_loss: 1354.0182223850 - val_landmark_loss: 3.3056157364 - val_labeled_loss: 3.3056157364 |█████████████████---| 89.0%  - val_loss: 1366.5619167752 - val_trvae_loss: 1363.4557088216 - val_landmark_loss: 3.1062019534 - val_labeled_loss: 3.1062019534 |██████████████████--| 90.0%  - val_loss: 1356.5537719727 - val_trvae_loss: 1354.1737942166 - val_landmark_loss: 2.3799740606 - val_labeled_loss: 2.3799740606 |██████████████████--| 91.0%  - val_loss: 1356.8476833767 - val_trvae_loss: 1354.1722344293 - val_landmark_loss: 2.6754455765 - val_labeled_loss: 2.6754455765 |██████████████████--| 92.0%  - val_loss: 1355.8193427192 - val_trvae_loss: 1353.3622165256 - val_landmark_loss: 2.4571330150 - val_labeled_loss: 2.4571330150 |██████████████████--| 93.0%  - val_loss: 1356.0273640951 - val_trvae_loss: 1353.5362955729 - val_landmark_loss: 2.4910809331 - val_labeled_loss: 2.4910809331 |██████████████████--| 94.0%  - val_loss: 1356.2363077799 - val_trvae_loss: 1353.7681070964 - val_landmark_loss: 2.4681975510 - val_labeled_loss: 2.4681975510 |███████████████████-| 95.0%  - val_loss: 1356.3322686089 - val_trvae_loss: 1353.7840169271 - val_landmark_loss: 2.5482554171 - val_labeled_loss: 2.5482554171 |███████████████████-| 96.0%  - val_loss: 1356.7770317925 - val_trvae_loss: 1354.6989407010 - val_landmark_loss: 2.0780988534 - val_labeled_loss: 2.0780988534 |███████████████████-| 97.0%  - val_loss: 1355.3968234592 - val_trvae_loss: 1353.3673095703 - val_landmark_loss: 2.0295138326 - val_labeled_loss: 2.0295138326 |███████████████████-| 98.0%  - val_loss: 1354.8975423177 - val_trvae_loss: 1353.2584296332 - val_landmark_loss: 1.6391332282 - val_labeled_loss: 1.6391332282 |███████████████████-| 99.0%  - val_loss: 1354.0761515299 - val_trvae_loss: 1352.2953423394 - val_landmark_loss: 1.7808051573 - val_labeled_loss: 1.7808051573 |████████████████████| 100.0%  - val_loss: 1355.4609442817 - val_trvae_loss: 1353.5753445095 - val_landmark_loss: 1.8856059346 - val_labeled_loss: 1.8856059346
2022-05-19 13:58:13 (INFO): Model trained and saved, initiate surgery
Saving best state of network...
Best State was in Epoch 97
AnnData object with n_obs × n_vars = 9581 × 4000
    obs: 'study', 'condition', 'cell_type', 'pred_label', 'pred_score'
    obsm: 'X_seurat', 'X_symphony'
Embedding dictionary:
 	Num conditions: 4
 	Embedding dim: 10
Encoder Architecture:
	Input Layer in, out and cond: 4000 128 0
	Hidden Layer 1 in/out: 128 128
	Hidden Layer 2 in/out: 128 128
	Mean/Var Layer in/out: 128 25
Decoder Architecture:
	First Layer in, out and cond:  25 128 10
	Hidden Layer 1 in/out: 128 128
	Hidden Layer 2 in/out: 128 128
	Output Layer in/out:  128 4000 

3
Warning: Labels in adata.obs[cell_type] is not a subset of label-encoder!
Therefore integer value of those labels is set to -1
Warning: Labels in adata.obs[cell_type] is not a subset of label-encoder!
Therefore integer value of those labels is set to -1
Warning: Labels in adata.obs[cell_type] is not a subset of label-encoder!
Therefore integer value of those labels is set to -1
Warning: Labels in adata.obs[cell_type] is not a subset of label-encoder!
Therefore integer value of those labels is set to -1
loaders init
loaders init done
0.1275033950805664
 |--------------------| 1.0%  - val_loss: 1400.9632568359 - val_trvae_loss: 1400.9632568359 |--------------------| 2.0%  - val_loss: 1383.2367248535 - val_trvae_loss: 1383.2367248535 |--------------------| 3.0%  - val_loss: 1363.6949157715 - val_trvae_loss: 1363.6949157715 |--------------------| 4.0%  - val_loss: 1358.9311370850 - val_trvae_loss: 1358.9311370850 |█-------------------| 5.0%  - val_loss: 1359.4748840332 - val_trvae_loss: 1359.4748840332 |█-------------------| 6.0%  - val_loss: 1329.3319854736 - val_trvae_loss: 1329.3319854736 |█-------------------| 7.0%  - val_loss: 1330.1191101074 - val_trvae_loss: 1330.1191101074 |█-------------------| 8.0%  - val_loss: 1325.4700927734 - val_trvae_loss: 1325.4700927734 |█-------------------| 9.0%  - val_loss: 1327.2872467041 - val_trvae_loss: 1327.2872467041 |██------------------| 10.0%  - val_loss: 1333.7530364990 - val_trvae_loss: 1333.7530364990 |██------------------| 11.0%  - val_loss: 1321.2930297852 - val_trvae_loss: 1321.2930297852 |██------------------| 12.0%  - val_loss: 1316.3385314941 - val_trvae_loss: 1316.3385314941 |██------------------| 13.0%  - val_loss: 1306.1057586670 - val_trvae_loss: 1306.1057586670 |██------------------| 14.0%  - val_loss: 1311.5229339600 - val_trvae_loss: 1311.5229339600 |███-----------------| 15.0%  - val_loss: 1298.3729095459 - val_trvae_loss: 1298.3729095459 |███-----------------| 16.0%  - val_loss: 1295.1772918701 - val_trvae_loss: 1295.1772918701 |███-----------------| 17.0%  - val_loss: 1277.2602691650 - val_trvae_loss: 1277.2602691650 |███-----------------| 18.0%  - val_loss: 1277.3631896973 - val_trvae_loss: 1277.3631896973 |███-----------------| 19.0%  - val_loss: 1271.2721405029 - val_trvae_loss: 1271.2721405029 |████----------------| 20.0%  - val_loss: 1273.8559570312 - val_trvae_loss: 1273.8559570312 |████----------------| 21.0%  - val_loss: 1283.0608215332 - val_trvae_loss: 1283.0608215332 |████----------------| 22.0%  - val_loss: 1275.6225738525 - val_trvae_loss: 1275.6225738525 |████----------------| 23.0%  - val_loss: 1276.5241088867 - val_trvae_loss: 1276.5241088867 |████----------------| 24.0%  - val_loss: 1275.8929595947 - val_trvae_loss: 1275.8929595947 |█████---------------| 25.0%  - val_loss: 1258.7734527588 - val_trvae_loss: 1258.7734527588 |█████---------------| 26.0%  - val_loss: 1256.8260498047 - val_trvae_loss: 1256.8260498047 |█████---------------| 27.0%  - val_loss: 1260.8565979004 - val_trvae_loss: 1260.8565979004 |█████---------------| 28.0%  - val_loss: 1262.7989044189 - val_trvae_loss: 1262.7989044189 |█████---------------| 29.0%  - val_loss: 1246.9063415527 - val_trvae_loss: 1246.9063415527 |██████--------------| 30.0%  - val_loss: 1248.8106231689 - val_trvae_loss: 1248.8106231689 |██████--------------| 31.0%  - val_loss: 1250.9323730469 - val_trvae_loss: 1250.9323730469 |██████--------------| 32.0%  - val_loss: 1256.2487640381 - val_trvae_loss: 1256.2487640381 |██████--------------| 33.0%  - val_loss: 1253.7826232910 - val_trvae_loss: 1253.7826232910 |██████--------------| 34.0%  - val_loss: 1246.3456268311 - val_trvae_loss: 1246.3456268311 |███████-------------| 35.0%  - val_loss: 1241.6388244629 - val_trvae_loss: 1241.6388244629 |███████-------------| 36.0%  - val_loss: 1240.1937866211 - val_trvae_loss: 1240.1937866211 |███████-------------| 37.0%  - val_loss: 1238.6859283447 - val_trvae_loss: 1238.6859283447 |███████-------------| 38.0%  - val_loss: 1235.2445373535 - val_trvae_loss: 1235.2445373535 |███████-------------| 39.0%  - val_loss: 1233.3636474609 - val_trvae_loss: 1233.3636474609 |████████------------| 40.0%  - val_loss: 1225.5177154541 - val_trvae_loss: 1225.5177154541 |████████------------| 41.0%  - val_loss: 1221.6873779297 - val_trvae_loss: 1221.6873779297 |████████------------| 42.0%  - val_loss: 1227.6118621826 - val_trvae_loss: 1227.6118621826 |████████------------| 43.0%  - val_loss: 1227.9637908936 - val_trvae_loss: 1227.9637908936 |████████------------| 44.0%  - val_loss: 1227.8828277588 - val_trvae_loss: 1227.8828277588 |█████████-----------| 45.0%  - val_loss: 1229.1712341309 - val_trvae_loss: 1229.1712341309 |█████████-----------| 46.0%  - val_loss: 1218.6799621582 - val_trvae_loss: 1218.6799621582 |█████████-----------| 47.0%  - val_loss: 1219.1697540283 - val_trvae_loss: 1219.1697540283 |█████████-----------| 48.0%  - val_loss: 1223.3361358643 - val_trvae_loss: 1223.3361358643 |█████████-----------| 49.0%  - val_loss: 1217.0886077881 - val_trvae_loss: 1217.0886077881 |██████████----------| 50.0%  - val_loss: 1222.6389160156 - val_trvae_loss: 1222.6389160156 |██████████----------| 51.0%  - val_loss: 1215.7957916260 - val_trvae_loss: 1215.7957916260 |██████████----------| 52.0%  - val_loss: 1223.3541412354 - val_trvae_loss: 1223.3541412354 |██████████----------| 53.0%  - val_loss: 1214.2236785889 - val_trvae_loss: 1214.2236785889 |██████████----------| 54.0%  - val_loss: 1218.9032440186 - val_trvae_loss: 1218.9032440186 |███████████---------| 55.0%  - val_loss: 1205.8437194824 - val_trvae_loss: 1205.8437194824 |███████████---------| 56.0%  - val_loss: 1214.7458648682 - val_trvae_loss: 1214.7458648682 |███████████---------| 57.0%  - val_loss: 1219.5646209717 - val_trvae_loss: 1219.5646209717 |███████████---------| 58.0%  - val_loss: 1215.4437103271 - val_trvae_loss: 1215.4437103271 |███████████---------| 59.0%  - val_loss: 1205.3369598389 - val_trvae_loss: 1205.3369598389 |████████████--------| 60.0%  - val_loss: 1214.8956298828 - val_trvae_loss: 1214.8956298828 |████████████--------| 61.0%  - val_loss: 1205.8271789551 - val_trvae_loss: 1205.8271789551 |████████████--------| 62.0%  - val_loss: 1216.3761596680 - val_trvae_loss: 1216.3761596680 |████████████--------| 63.0%  - val_loss: 1202.8661804199 - val_trvae_loss: 1202.8661804199 |████████████--------| 64.0%  - val_loss: 1209.3226928711 - val_trvae_loss: 1209.3226928711 |█████████████-------| 65.0%  - val_loss: 1205.9844207764 - val_trvae_loss: 1205.9844207764 |█████████████-------| 66.0%  - val_loss: 1209.6323242188 - val_trvae_loss: 1209.6323242188 |█████████████-------| 67.0%  - val_loss: 1206.9346771240 - val_trvae_loss: 1206.9346771240 |█████████████-------| 68.0%  - val_loss: 1205.1372528076 - val_trvae_loss: 1205.1372528076 |█████████████-------| 69.0%  - val_loss: 1200.6605834961 - val_trvae_loss: 1200.6605834961 |██████████████------| 70.0%  - val_loss: 1198.3579101562 - val_trvae_loss: 1198.3579101562 |██████████████------| 71.0%  - val_loss: 1203.4895477295 - val_trvae_loss: 1203.4895477295 |██████████████------| 72.0%  - val_loss: 1204.8342590332 - val_trvae_loss: 1204.8342590332 |██████████████------| 73.0%  - val_loss: 1199.8168945312 - val_trvae_loss: 1199.8168945312 |██████████████------| 74.0%  - val_loss: 1199.9401702881 - val_trvae_loss: 1199.9401702881 |███████████████-----| 75.0%  - val_loss: 1194.3404998779 - val_trvae_loss: 1194.3404998779 |███████████████-----| 76.0%  - val_loss: 1196.3870086670 - val_trvae_loss: 1196.3870086670 |███████████████-----| 77.0%  - val_loss: 1195.2177429199 - val_trvae_loss: 1195.2177429199 |███████████████-----| 78.0%  - val_loss: 1199.0332794189 - val_trvae_loss: 1199.0332794189 |███████████████-----| 79.0%  - val_loss: 1189.2278594971 - val_trvae_loss: 1189.2278594971 |████████████████----| 80.0%  - val_loss: 1206.7097167969 - val_trvae_loss: 1206.7097167969
Initializing unlabeled landmarks with Leiden-Clustering with an unknown number of clusters.
Leiden Clustering succesful. Found 21 clusters.
 |████████████████----| 81.0%  - val_loss: 1190.5944824219 - val_trvae_loss: 1190.5942382812 - val_landmark_loss: 0.0002384787 - val_unlabeled_loss: 0.2384787109 |████████████████----| 82.0%  - val_loss: 1188.7891387939 - val_trvae_loss: 1188.7888946533 - val_landmark_loss: 0.0002411154 - val_unlabeled_loss: 0.2411153410 |████████████████----| 83.0%  - val_loss: 1189.2868347168 - val_trvae_loss: 1189.2865905762 - val_landmark_loss: 0.0002409211 - val_unlabeled_loss: 0.2409210727 |████████████████----| 84.0%  - val_loss: 1192.5090789795 - val_trvae_loss: 1192.5088348389 - val_landmark_loss: 0.0002280830 - val_unlabeled_loss: 0.2280829847 |█████████████████---| 85.0%  - val_loss: 1200.2481994629 - val_trvae_loss: 1200.2479553223 - val_landmark_loss: 0.0002437664 - val_unlabeled_loss: 0.2437664345 |█████████████████---| 86.0%  - val_loss: 1194.0312500000 - val_trvae_loss: 1194.0310058594 - val_landmark_loss: 0.0002381390 - val_unlabeled_loss: 0.2381389607 |█████████████████---| 87.0%  - val_loss: 1194.5430450439 - val_trvae_loss: 1194.5428009033 - val_landmark_loss: 0.0002301923 - val_unlabeled_loss: 0.2301922850 |█████████████████---| 88.0%  - val_loss: 1186.5162658691 - val_trvae_loss: 1186.5160217285 - val_landmark_loss: 0.0002449350 - val_unlabeled_loss: 0.2449349817 |█████████████████---| 89.0%  - val_loss: 1194.3111877441 - val_trvae_loss: 1194.3109436035 - val_landmark_loss: 0.0002364231 - val_unlabeled_loss: 0.2364230491 |██████████████████--| 90.0%  - val_loss: 1183.1173553467 - val_trvae_loss: 1183.1171112061 - val_landmark_loss: 0.0002299032 - val_unlabeled_loss: 0.2299032193 |██████████████████--| 91.0%  - val_loss: 1189.5988616943 - val_trvae_loss: 1189.5986175537 - val_landmark_loss: 0.0002288069 - val_unlabeled_loss: 0.2288068980 |██████████████████--| 92.0%  - val_loss: 1183.3315582275 - val_trvae_loss: 1183.3313140869 - val_landmark_loss: 0.0002395937 - val_unlabeled_loss: 0.2395937387 |██████████████████--| 93.0%  - val_loss: 1193.0457000732 - val_trvae_loss: 1193.0454559326 - val_landmark_loss: 0.0002292220 - val_unlabeled_loss: 0.2292219531 |██████████████████--| 94.0%  - val_loss: 1186.3367309570 - val_trvae_loss: 1186.3365020752 - val_landmark_loss: 0.0002369072 - val_unlabeled_loss: 0.2369071711 |███████████████████-| 95.0%  - val_loss: 1196.0156707764 - val_trvae_loss: 1196.0154266357 - val_landmark_loss: 0.0002330473 - val_unlabeled_loss: 0.2330473065 |███████████████████-| 96.0%  - val_loss: 1189.0173645020 - val_trvae_loss: 1189.0171203613 - val_landmark_loss: 0.0002264215 - val_unlabeled_loss: 0.2264214661 |███████████████████-| 97.0%  - val_loss: 1182.5009765625 - val_trvae_loss: 1182.5007476807 - val_landmark_loss: 0.0002349739 - val_unlabeled_loss: 0.2349739242 |███████████████████-| 98.0%  - val_loss: 1192.4626007080 - val_trvae_loss: 1192.4623565674 - val_landmark_loss: 0.0002414291 - val_unlabeled_loss: 0.2414290980 |███████████████████-| 99.0%  - val_loss: 1185.0634155273 - val_trvae_loss: 1185.0631866455 - val_landmark_loss: 0.0002389019 - val_unlabeled_loss: 0.2389018722 |████████████████████| 100.0%  - val_loss: 1189.2102661133 - val_trvae_loss: 1189.2100372314 - val_landmark_loss: 0.0002300360 - val_unlabeled_loss: 0.2300360203
/home/icb/carlo.dedonno/anaconda3/envs/lataq_cuda/lib/python3.8/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y, hue. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(
2022-05-19 13:59:28 (INFO): Computing metrics
/home/icb/carlo.dedonno/anaconda3/envs/lataq_cuda/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/icb/carlo.dedonno/anaconda3/envs/lataq_cuda/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/icb/carlo.dedonno/anaconda3/envs/lataq_cuda/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/icb/carlo.dedonno/anaconda3/envs/lataq_cuda/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/icb/carlo.dedonno/anaconda3/envs/lataq_cuda/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/icb/carlo.dedonno/anaconda3/envs/lataq_cuda/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
2022-05-19 13:59:30 (INFO): Compute integration metrics
... storing 'study' as categorical
... storing 'cell_type' as categorical
2022-05-19 14:16:33 (INFO): Result: {'distances':   condition  cos_dist  eucl_dist
0       10X  1.419428   0.816171
1       Sun  1.010056   0.806848
2   Freytag  0.456266   0.694576
3    Oetjen  0.456266   0.694576, 'classification_report':                                   precision    recall  f1-score      support
CD10+ B cells                      0.000000  0.000000  0.000000    207.00000
CD14+ Monocytes                    0.965194  0.975702  0.970420   6338.00000
CD16+ Monocytes                    0.902305  0.996364  0.947005    825.00000
CD20+ B cells                      0.985381  0.985381  0.985381   2873.00000
CD4+ T cells                       0.912837  0.959677  0.935671  11011.00000
CD8+ T cells                       0.814140  0.696290  0.750617   2183.00000
Erythrocytes                       0.000000  0.000000  0.000000   1502.00000
Erythroid progenitors              0.000000  0.000000  0.000000    463.00000
HSPCs                              0.159640  0.824524  0.267490    473.00000
Megakaryocyte progenitors          0.782609  0.200000  0.318584    270.00000
Monocyte progenitors               0.000000  0.000000  0.000000    428.00000
Monocyte-derived dendritic cells   0.694891  0.995816  0.818573    478.00000
NK cells                           0.970060  0.776809  0.862745   2294.00000
NKT cells                          0.797097  0.920219  0.854244   2745.00000
Plasma cells                       0.333333  0.961240  0.495010    129.00000
Plasmacytoid dendritic cells       0.949091  0.984906  0.966667    265.00000
accuracy                           0.847710  0.847710  0.847710      0.84771
macro avg                          0.579161  0.642308  0.573275  32484.00000
weighted avg                       0.826504  0.847710  0.829699  32484.00000, 'classification_report_query':                                   precision    recall  f1-score      support
CD10+ B cells                      0.000000  0.000000  0.000000   207.000000
CD14+ Monocytes                    0.811755  0.955868  0.877936   997.000000
CD16+ Monocytes                    0.948276  1.000000  0.973451   165.000000
CD20+ B cells                      0.920696  0.969450  0.944444   491.000000
CD4+ T cells                       0.721034  0.961569  0.824109  2524.000000
CD8+ T cells                       0.802935  0.388832  0.523940   985.000000
Erythrocytes                       0.000000  0.000000  0.000000  1502.000000
Erythroid progenitors              0.000000  0.000000  0.000000   463.000000
HSPCs                              0.150645  0.813483  0.254213   445.000000
Megakaryocyte progenitors          0.166667  0.013699  0.025316   219.000000
Monocyte progenitors               0.000000  0.000000  0.000000   428.000000
Monocyte-derived dendritic cells   0.541985  0.995327  0.701812   214.000000
NK cells                           0.690265  0.876404  0.772277    89.000000
NKT cells                          0.900424  0.699013  0.787037   608.000000
Plasma cells                       0.316265  0.945946  0.474041   111.000000
Plasmacytoid dendritic cells       0.915493  0.977444  0.945455   133.000000
accuracy                           0.597015  0.597015  0.597015     0.597015
macro avg                          0.492902  0.599815  0.506502  9581.000000
weighted avg                       0.523318  0.597015  0.531286  9581.000000, 'integration_scores':    NMI_cluster/label  ARI_cluster/label  ...  isolated_label_silhouette  graph_conn
0           0.823506           0.838255  ...                   0.551889    0.965227

[1 rows x 8 columns]}
Saving best state of network...
Best State was in Epoch 95
NMI...
ARI...
Silhouette score...
PC regression...
Isolated labels F1...
Isolated labels ASW...
Graph connectivity...
2022-05-19 14:16:33 (INFO): Completed after 0:21:25
