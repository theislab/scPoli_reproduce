Starting job 3782802
SLURM assigned me the node(s): gpusrv13
Experiments are running under the following process IDs:
Experiment ID: 9	Process ID: 20180

During startup - Warning messages:
1: package ‘methods’ was built under R version 3.6.3 
2: package ‘datasets’ was built under R version 3.6.3 
3: package ‘utils’ was built under R version 3.6.3 
4: package ‘grDevices’ was built under R version 3.6.3 
5: package ‘graphics’ was built under R version 3.6.3 
6: package ‘stats’ was built under R version 3.6.3 
2021-10-26 15:16:09 (INFO): Running command 'run'
2021-10-26 15:16:09 (INFO): Started run with ID "9"
2021-10-26 15:16:11 (INFO): Data loaded succesfully
2021-10-26 15:16:11 (INFO): Model instantiated
Embedding dictionary:
 	Num conditions: 3
 	Embedding dim: 10
Encoder Architecture:
	Input Layer in, out and cond: 4000 128 0
	Hidden Layer 1 in/out: 128 128
	Hidden Layer 2 in/out: 128 128
	Mean/Var Layer in/out: 128 25
Decoder Architecture:
	First Layer in, out and cond:  25 128 10
	Hidden Layer 1 in/out: 128 128
	Hidden Layer 2 in/out: 128 128
	Output Layer in/out:  128 4000 

 |--------------------| 1.0%  - val_loss: 1158.7745648552 - val_trvae_loss: 1158.7745648552 |--------------------| 2.0%  - val_loss: 1123.4178502700 - val_trvae_loss: 1123.4178502700 |--------------------| 3.0%  - val_loss: 1108.5992072610 - val_trvae_loss: 1108.5992072610 |--------------------| 4.0%  - val_loss: 1100.5853379193 - val_trvae_loss: 1100.5853379193 |█-------------------| 5.0%  - val_loss: 1094.7072394876 - val_trvae_loss: 1094.7072394876 |█-------------------| 6.0%  - val_loss: 1089.6942389993 - val_trvae_loss: 1089.6942389993 |█-------------------| 7.0%  - val_loss: 1084.4929486443 - val_trvae_loss: 1084.4929486443 |█-------------------| 8.0%  - val_loss: 1081.6729125977 - val_trvae_loss: 1081.6729125977 |█-------------------| 9.0%  - val_loss: 1079.1262566062 - val_trvae_loss: 1079.1262566062 |██------------------| 10.0%  - val_loss: 1076.4553581687 - val_trvae_loss: 1076.4553581687 |██------------------| 11.0%  - val_loss: 1074.9557171990 - val_trvae_loss: 1074.9557171990 |██------------------| 12.0%  - val_loss: 1072.7342960133 - val_trvae_loss: 1072.7342960133 |██------------------| 13.0%  - val_loss: 1072.2342601103 - val_trvae_loss: 1072.2342601103 |██------------------| 14.0%  - val_loss: 1071.6373901367 - val_trvae_loss: 1071.6373901367 |███-----------------| 15.0%  - val_loss: 1069.6058995864 - val_trvae_loss: 1069.6058995864 |███-----------------| 16.0%  - val_loss: 1071.2513176413 - val_trvae_loss: 1071.2513176413 |███-----------------| 17.0%  - val_loss: 1069.3628252815 - val_trvae_loss: 1069.3628252815 |███-----------------| 18.0%  - val_loss: 1067.5839915556 - val_trvae_loss: 1067.5839915556 |███-----------------| 19.0%  - val_loss: 1066.8821195715 - val_trvae_loss: 1066.8821195715 |████----------------| 20.0%  - val_loss: 1067.7010282629 - val_trvae_loss: 1067.7010282629 |████----------------| 21.0%  - val_loss: 1066.3972239775 - val_trvae_loss: 1066.3972239775 |████----------------| 22.0%  - val_loss: 1065.5550644818 - val_trvae_loss: 1065.5550644818 |████----------------| 23.0%  - val_loss: 1064.9160263959 - val_trvae_loss: 1064.9160263959 |████----------------| 24.0%  - val_loss: 1064.6288775276 - val_trvae_loss: 1064.6288775276 |█████---------------| 25.0%  - val_loss: 1066.2340949563 - val_trvae_loss: 1066.2340949563 |█████---------------| 26.0%  - val_loss: 1065.8592134364 - val_trvae_loss: 1065.8592134364 |█████---------------| 27.0%  - val_loss: 1064.0154454848 - val_trvae_loss: 1064.0154454848 |█████---------------| 28.0%  - val_loss: 1063.6582964729 - val_trvae_loss: 1063.6582964729 |█████---------------| 29.0%  - val_loss: 1063.4872867360 - val_trvae_loss: 1063.4872867360 |██████--------------| 30.0%  - val_loss: 1065.1542932847 - val_trvae_loss: 1065.1542932847 |██████--------------| 31.0%  - val_loss: 1063.2774909524 - val_trvae_loss: 1063.2774909524 |██████--------------| 32.0%  - val_loss: 1063.7762271657 - val_trvae_loss: 1063.7762271657 |██████--------------| 33.0%  - val_loss: 1063.1997572955 - val_trvae_loss: 1063.1997572955 |██████--------------| 34.0%  - val_loss: 1062.9989408605 - val_trvae_loss: 1062.9989408605 |███████-------------| 35.0%  - val_loss: 1063.9703620462 - val_trvae_loss: 1063.9703620462 |███████-------------| 36.0%  - val_loss: 1062.3165067785 - val_trvae_loss: 1062.3165067785 |███████-------------| 37.0%  - val_loss: 1063.4134952321 - val_trvae_loss: 1063.4134952321 |███████-------------| 38.0%  - val_loss: 1063.4106229894 - val_trvae_loss: 1063.4106229894 |███████-------------| 39.0%  - val_loss: 1063.4189381319 - val_trvae_loss: 1063.4189381319 |████████------------| 40.0%  - val_loss: 1062.8704833984 - val_trvae_loss: 1062.8704833984 |████████------------| 41.0%  - val_loss: 1062.4270665786 - val_trvae_loss: 1062.4270665786 |████████------------| 42.0%  - val_loss: 1062.6609820198 - val_trvae_loss: 1062.6609820198 |████████------------| 43.0%  - val_loss: 1062.2415484260 - val_trvae_loss: 1062.2415484260 |████████------------| 44.0%  - val_loss: 1062.4352488798 - val_trvae_loss: 1062.4352488798 |█████████-----------| 45.0%  - val_loss: 1062.1370382870 - val_trvae_loss: 1062.1370382870 |█████████-----------| 46.0%  - val_loss: 1062.2651474897 - val_trvae_loss: 1062.2651474897 |█████████-----------| 47.0%  - val_loss: 1062.1672076057 - val_trvae_loss: 1062.1672076057 |█████████-----------| 48.0%  - val_loss: 1062.5038164924 - val_trvae_loss: 1062.5038164924 |█████████-----------| 49.0%  - val_loss: 1061.4899471507 - val_trvae_loss: 1061.4899471507 |██████████----------| 50.0%  - val_loss: 1064.1952586455 - val_trvae_loss: 1064.1952586455 |██████████----------| 51.0%  - val_loss: 1062.0245612649 - val_trvae_loss: 1062.0245612649 |██████████----------| 52.0%  - val_loss: 1061.2061623966 - val_trvae_loss: 1061.2061623966 |██████████----------| 53.0%  - val_loss: 1061.2630256204 - val_trvae_loss: 1061.2630256204 |██████████----------| 54.0%  - val_loss: 1062.0157614315 - val_trvae_loss: 1062.0157614315 |███████████---------| 55.0%  - val_loss: 1065.3147798426 - val_trvae_loss: 1065.3147798426 |███████████---------| 56.0%  - val_loss: 1061.1417379940 - val_trvae_loss: 1061.1417379940 |███████████---------| 57.0%  - val_loss: 1060.6661233341 - val_trvae_loss: 1060.6661233341 |███████████---------| 58.0%  - val_loss: 1060.9092586742 - val_trvae_loss: 1060.9092586742 |███████████---------| 59.0%  - val_loss: 1061.6635957606 - val_trvae_loss: 1061.6635957606 |████████████--------| 60.0%  - val_loss: 1060.8559857537 - val_trvae_loss: 1060.8559857537 |████████████--------| 61.0%  - val_loss: 1061.1937291762 - val_trvae_loss: 1061.1937291762 |████████████--------| 62.0%  - val_loss: 1063.2230511834 - val_trvae_loss: 1063.2230511834 |████████████--------| 63.0%  - val_loss: 1061.7302353803 - val_trvae_loss: 1061.7302353803 |████████████--------| 64.0%  - val_loss: 1060.3077643899 - val_trvae_loss: 1060.3077643899 |█████████████-------| 65.0%  - val_loss: 1061.3611234777 - val_trvae_loss: 1061.3611234777 |█████████████-------| 66.0%  - val_loss: 1060.5819055894 - val_trvae_loss: 1060.5819055894 |█████████████-------| 67.0%  - val_loss: 1060.4419447955 - val_trvae_loss: 1060.4419447955 |█████████████-------| 68.0%  - val_loss: 1060.0925328872 - val_trvae_loss: 1060.0925328872 |█████████████-------| 69.0%  - val_loss: 1060.0402293486 - val_trvae_loss: 1060.0402293486 |██████████████------| 70.0%  - val_loss: 1060.6280517578 - val_trvae_loss: 1060.6280517578 |██████████████------| 71.0%  - val_loss: 1059.9937061983 - val_trvae_loss: 1059.9937061983 |██████████████------| 72.0%  - val_loss: 1059.3456528608 - val_trvae_loss: 1059.3456528608 |██████████████------| 73.0%  - val_loss: 1062.0132482192 - val_trvae_loss: 1062.0132482192 |██████████████------| 74.0%  - val_loss: 1060.8626673081 - val_trvae_loss: 1060.8626673081 |███████████████-----| 75.0%  - val_loss: 1060.2182365866 - val_trvae_loss: 1060.2182365866 |███████████████-----| 76.0%  - val_loss: 1060.2170912799 - val_trvae_loss: 1060.2170912799 |███████████████-----| 77.0%  - val_loss: 1060.1594597312 - val_trvae_loss: 1060.1594597312 |███████████████-----| 78.0%  - val_loss: 1071.2632123162 - val_trvae_loss: 1071.2632123162 |███████████████-----| 79.0%  - val_loss: 1060.6288703470 - val_trvae_loss: 1060.6288703470 |████████████████----| 80.0%  - val_loss: 1060.1640230067 - val_trvae_loss: 1060.1640230067 |████████████████----| 81.0%  - val_loss: 1081.5230353860 - val_trvae_loss: 1067.0065092199 - val_landmark_loss: 14.5165284101 - val_labeled_loss: 14.5165284101 |████████████████----| 82.0%  - val_loss: 1077.1886022231 - val_trvae_loss: 1066.8007309858 - val_landmark_loss: 10.3878764545 - val_labeled_loss: 10.3878764545 |████████████████----| 83.0%  - val_loss: 1074.1127570657 - val_trvae_loss: 1064.5870935777 - val_landmark_loss: 9.5256689857 - val_labeled_loss: 9.5256689857 |████████████████----| 84.0%  - val_loss: 1072.5158835018 - val_trvae_loss: 1064.3593139648 - val_landmark_loss: 8.1565596216 - val_labeled_loss: 8.1565596216 |█████████████████---| 85.0%  - val_loss: 1073.5246438419 - val_trvae_loss: 1065.5760892980 - val_landmark_loss: 7.9485499719 - val_labeled_loss: 7.9485499719 |█████████████████---| 86.0%  - val_loss: 1070.7093793084 - val_trvae_loss: 1064.4340712603 - val_landmark_loss: 6.2753049205 - val_labeled_loss: 6.2753049205 |█████████████████---| 87.0%  - val_loss: 1068.9135562672 - val_trvae_loss: 1063.1071310604 - val_landmark_loss: 5.8064370155 - val_labeled_loss: 5.8064370155 |█████████████████---| 88.0%  - val_loss: 1069.0215956744 - val_trvae_loss: 1063.4611098346 - val_landmark_loss: 5.5604831191 - val_labeled_loss: 5.5604831191 |█████████████████---| 89.0%  - val_loss: 1068.7935467888 - val_trvae_loss: 1063.8418830423 - val_landmark_loss: 4.9516664533 - val_labeled_loss: 4.9516664533 |██████████████████--| 90.0%  - val_loss: 1068.7143375172 - val_trvae_loss: 1064.3949225931 - val_landmark_loss: 4.3194063692 - val_labeled_loss: 4.3194063692 |██████████████████--| 91.0%  - val_loss: 1081.5524615119 - val_trvae_loss: 1076.8453835880 - val_landmark_loss: 4.7070778678 - val_labeled_loss: 4.7070778678 |██████████████████--| 92.0%  - val_loss: 1072.3669792624 - val_trvae_loss: 1067.3507654527 - val_landmark_loss: 5.0162287179 - val_labeled_loss: 5.0162287179 |██████████████████--| 93.0%  - val_loss: 1067.6711748909 - val_trvae_loss: 1063.4935338637 - val_landmark_loss: 4.1776360624 - val_labeled_loss: 4.1776360624 |██████████████████--| 94.0%  - val_loss: 1066.7199850643 - val_trvae_loss: 1062.9368609260 - val_landmark_loss: 3.7831392288 - val_labeled_loss: 3.7831392288 |███████████████████-| 95.0%  - val_loss: 1066.7850736730 - val_trvae_loss: 1062.4857752183 - val_landmark_loss: 4.2992892055 - val_labeled_loss: 4.2992892055 |███████████████████-| 96.0%  - val_loss: 1065.4152149874 - val_trvae_loss: 1062.0010770910 - val_landmark_loss: 3.4141275041 - val_labeled_loss: 3.4141275041 |███████████████████-| 97.0%  - val_loss: 1066.2491490981 - val_trvae_loss: 1063.0625933479 - val_landmark_loss: 3.1865491236 - val_labeled_loss: 3.1865491236 |███████████████████-| 98.0%  - val_loss: 1067.8337545956 - val_trvae_loss: 1064.3634966682 - val_landmark_loss: 3.4702525279 - val_labeled_loss: 3.4702525279 |███████████████████-| 99.0%  - val_loss: 1065.8258990119 - val_trvae_loss: 1062.3446942498 - val_landmark_loss: 3.4812143831 - val_labeled_loss: 3.4812143831 |████████████████████| 100.0%  - val_loss: 1065.0090870577 - val_trvae_loss: 1061.8442885455 - val_landmark_loss: 3.1647866333 - val_labeled_loss: 3.1647866333
2021-10-26 15:19:08 (INFO): Model trained and saved, initiate surgery
Saving best state of network...
Best State was in Epoch 99
AnnData object with n_obs × n_vars = 10727 × 4000
    obs: 'study', 'condition', 'cell_type', 'pred_label', 'pred_score'
    obsm: 'X_seurat', 'X_symphony'
Embedding dictionary:
 	Num conditions: 4
 	Embedding dim: 10
Encoder Architecture:
	Input Layer in, out and cond: 4000 128 0
	Hidden Layer 1 in/out: 128 128
	Hidden Layer 2 in/out: 128 128
	Mean/Var Layer in/out: 128 25
Decoder Architecture:
	First Layer in, out and cond:  25 128 10
	Hidden Layer 1 in/out: 128 128
	Hidden Layer 2 in/out: 128 128
	Output Layer in/out:  128 4000 

 |--------------------| 1.0%  - val_loss: 2019.3274061415 - val_trvae_loss: 2019.3274061415 |--------------------| 2.0%  - val_loss: 2014.6517333984 - val_trvae_loss: 2014.6517333984 |--------------------| 3.0%  - val_loss: 2013.9084743924 - val_trvae_loss: 2013.9084743924 |--------------------| 4.0%  - val_loss: 2012.9965277778 - val_trvae_loss: 2012.9965277778 |█-------------------| 5.0%  - val_loss: 2005.0134955512 - val_trvae_loss: 2005.0134955512 |█-------------------| 6.0%  - val_loss: 1990.3960639106 - val_trvae_loss: 1990.3960639106 |█-------------------| 7.0%  - val_loss: 1997.6103651259 - val_trvae_loss: 1997.6103651259 |█-------------------| 8.0%  - val_loss: 1979.9461534288 - val_trvae_loss: 1979.9461534288 |█-------------------| 9.0%  - val_loss: 1995.3500840929 - val_trvae_loss: 1995.3500840929 |██------------------| 10.0%  - val_loss: 1979.7387017144 - val_trvae_loss: 1979.7387017144 |██------------------| 11.0%  - val_loss: 1969.9115261502 - val_trvae_loss: 1969.9115261502 |██------------------| 12.0%  - val_loss: 1973.4182807075 - val_trvae_loss: 1973.4182807075 |██------------------| 13.0%  - val_loss: 1981.1651340061 - val_trvae_loss: 1981.1651340061 |██------------------| 14.0%  - val_loss: 1967.9760335286 - val_trvae_loss: 1967.9760335286 |███-----------------| 15.0%  - val_loss: 1982.7194146050 - val_trvae_loss: 1982.7194146050 |███-----------------| 16.0%  - val_loss: 1970.5442165799 - val_trvae_loss: 1970.5442165799 |███-----------------| 17.0%  - val_loss: 1981.7340494792 - val_trvae_loss: 1981.7340494792 |███-----------------| 18.0%  - val_loss: 1966.8245442708 - val_trvae_loss: 1966.8245442708 |███-----------------| 19.0%  - val_loss: 1968.0105251736 - val_trvae_loss: 1968.0105251736 |████----------------| 20.0%  - val_loss: 1963.0678032769 - val_trvae_loss: 1963.0678032769 |████----------------| 21.0%  - val_loss: 1963.0131564670 - val_trvae_loss: 1963.0131564670 |████----------------| 22.0%  - val_loss: 1953.4354383681 - val_trvae_loss: 1953.4354383681 |████----------------| 23.0%  - val_loss: 1964.0764024523 - val_trvae_loss: 1964.0764024523 |████----------------| 24.0%  - val_loss: 1953.9562445747 - val_trvae_loss: 1953.9562445747 |█████---------------| 25.0%  - val_loss: 1953.3995903863 - val_trvae_loss: 1953.3995903863 |█████---------------| 26.0%  - val_loss: 1950.7716471354 - val_trvae_loss: 1950.7716471354 |█████---------------| 27.0%  - val_loss: 1948.7544487847 - val_trvae_loss: 1948.7544487847 |█████---------------| 28.0%  - val_loss: 1948.7147623698 - val_trvae_loss: 1948.7147623698 |█████---------------| 29.0%  - val_loss: 1961.4901394314 - val_trvae_loss: 1961.4901394314 |██████--------------| 30.0%  - val_loss: 1960.1370171441 - val_trvae_loss: 1960.1370171441 |██████--------------| 31.0%  - val_loss: 1964.5120442708 - val_trvae_loss: 1964.5120442708 |██████--------------| 32.0%  - val_loss: 1953.0190972222 - val_trvae_loss: 1953.0190972222 |██████--------------| 33.0%  - val_loss: 1962.1509467231 - val_trvae_loss: 1962.1509467231 |██████--------------| 34.0%  - val_loss: 1962.9569498698 - val_trvae_loss: 1962.9569498698 |███████-------------| 35.0%  - val_loss: 1945.8491889106 - val_trvae_loss: 1945.8491889106 |███████-------------| 36.0%  - val_loss: 1943.5409884983 - val_trvae_loss: 1943.5409884983 |███████-------------| 37.0%  - val_loss: 1963.8650309245 - val_trvae_loss: 1963.8650309245 |███████-------------| 38.0%  - val_loss: 1954.2709689670 - val_trvae_loss: 1954.2709689670 |███████-------------| 39.0%  - val_loss: 1945.4559733073 - val_trvae_loss: 1945.4559733073 |████████------------| 40.0%  - val_loss: 1934.8983289931 - val_trvae_loss: 1934.8983289931 |████████------------| 41.0%  - val_loss: 1945.6674533420 - val_trvae_loss: 1945.6674533420 |████████------------| 42.0%  - val_loss: 1940.4881320530 - val_trvae_loss: 1940.4881320530 |████████------------| 43.0%  - val_loss: 1950.3897433811 - val_trvae_loss: 1950.3897433811 |████████------------| 44.0%  - val_loss: 1947.9434678819 - val_trvae_loss: 1947.9434678819 |█████████-----------| 45.0%  - val_loss: 1953.5134412977 - val_trvae_loss: 1953.5134412977 |█████████-----------| 46.0%  - val_loss: 1942.2327473958 - val_trvae_loss: 1942.2327473958 |█████████-----------| 47.0%  - val_loss: 1944.6358913845 - val_trvae_loss: 1944.6358913845 |█████████-----------| 48.0%  - val_loss: 1942.5824924045 - val_trvae_loss: 1942.5824924045 |█████████-----------| 49.0%  - val_loss: 1937.1403537326 - val_trvae_loss: 1937.1403537326 |██████████----------| 50.0%  - val_loss: 1936.9298502604 - val_trvae_loss: 1936.9298502604 |██████████----------| 51.0%  - val_loss: 1947.9069824219 - val_trvae_loss: 1947.9069824219 |██████████----------| 52.0%  - val_loss: 1937.1569417318 - val_trvae_loss: 1937.1569417318 |██████████----------| 53.0%  - val_loss: 1952.0622694227 - val_trvae_loss: 1952.0622694227 |██████████----------| 54.0%  - val_loss: 1952.6836344401 - val_trvae_loss: 1952.6836344401 |███████████---------| 55.0%  - val_loss: 1945.2901475694 - val_trvae_loss: 1945.2901475694 |███████████---------| 56.0%  - val_loss: 1944.0900472005 - val_trvae_loss: 1944.0900472005 |███████████---------| 57.0%  - val_loss: 1934.7518988715 - val_trvae_loss: 1934.7518988715 |███████████---------| 58.0%  - val_loss: 1949.0571017795 - val_trvae_loss: 1949.0571017795 |███████████---------| 59.0%  - val_loss: 1943.3896620009 - val_trvae_loss: 1943.3896620009 |████████████--------| 60.0%  - val_loss: 1947.1390923394 - val_trvae_loss: 1947.1390923394 |████████████--------| 61.0%  - val_loss: 1942.0585530599 - val_trvae_loss: 1942.0585530599 |████████████--------| 62.0%  - val_loss: 1934.9869113498 - val_trvae_loss: 1934.9869113498 |████████████--------| 63.0%  - val_loss: 1936.6778021918 - val_trvae_loss: 1936.6778021918 |████████████--------| 64.0%  - val_loss: 1933.6246202257 - val_trvae_loss: 1933.6246202257 |█████████████-------| 65.0%  - val_loss: 1938.7963731554 - val_trvae_loss: 1938.7963731554 |█████████████-------| 66.0%  - val_loss: 1938.3493109809 - val_trvae_loss: 1938.3493109809 |█████████████-------| 67.0%  - val_loss: 1949.1822374132 - val_trvae_loss: 1949.1822374132 |█████████████-------| 68.0%  - val_loss: 1927.0484890408 - val_trvae_loss: 1927.0484890408 |█████████████-------| 69.0%  - val_loss: 1943.5076633030 - val_trvae_loss: 1943.5076633030 |██████████████------| 70.0%  - val_loss: 1940.5969509549 - val_trvae_loss: 1940.5969509549 |██████████████------| 71.0%  - val_loss: 1945.4346652561 - val_trvae_loss: 1945.4346652561 |██████████████------| 72.0%  - val_loss: 1958.8229980469 - val_trvae_loss: 1958.8229980469 |██████████████------| 73.0%  - val_loss: 1955.1595730252 - val_trvae_loss: 1955.1595730252 |██████████████------| 74.0%  - val_loss: 1938.1657307943 - val_trvae_loss: 1938.1657307943 |███████████████-----| 75.0%  - val_loss: 1938.9463704427 - val_trvae_loss: 1938.9463704427 |███████████████-----| 76.0%  - val_loss: 1959.2530788845 - val_trvae_loss: 1959.2530788845 |███████████████-----| 77.0%  - val_loss: 1944.4643419054 - val_trvae_loss: 1944.4643419054 |███████████████-----| 78.0%  - val_loss: 1934.2038167318 - val_trvae_loss: 1934.2038167318 |███████████████-----| 79.0%  - val_loss: 1953.4970160590 - val_trvae_loss: 1953.4970160590 |████████████████----| 80.0%  - val_loss: 1944.1177435981 - val_trvae_loss: 1944.1177435981
Initializing unlabeled landmarks with Leiden-Clustering with an unknown number of clusters.
Leiden Clustering succesful. Found 21 clusters.
 |████████████████----| 81.0%  - val_loss: 1953.6758083767 - val_trvae_loss: 1953.6756727431 - val_landmark_loss: 0.0001295270 - val_unlabeled_loss: 0.1295269968 |████████████████----| 82.0%  - val_loss: 1942.8821885851 - val_trvae_loss: 1942.8820529514 - val_landmark_loss: 0.0001294696 - val_unlabeled_loss: 0.1294695768 |████████████████----| 83.0%  - val_loss: 1940.7514648438 - val_trvae_loss: 1940.7513292101 - val_landmark_loss: 0.0001461661 - val_unlabeled_loss: 0.1461661152 |████████████████----| 84.0%  - val_loss: 1936.4692925347 - val_trvae_loss: 1936.4691704644 - val_landmark_loss: 0.0001473020 - val_unlabeled_loss: 0.1473019545 |█████████████████---| 85.0%  - val_loss: 1932.0424262153 - val_trvae_loss: 1932.0422770182 - val_landmark_loss: 0.0001462307 - val_unlabeled_loss: 0.1462307423 |█████████████████---| 86.0%  - val_loss: 1939.0853678385 - val_trvae_loss: 1939.0852050781 - val_landmark_loss: 0.0001323719 - val_unlabeled_loss: 0.1323719364 |█████████████████---| 87.0%  - val_loss: 1950.8179660373 - val_trvae_loss: 1950.8178304036 - val_landmark_loss: 0.0001424581 - val_unlabeled_loss: 0.1424580531 |█████████████████---| 88.0%  - val_loss: 1937.9323594835 - val_trvae_loss: 1937.9322374132 - val_landmark_loss: 0.0001265841 - val_unlabeled_loss: 0.1265840787 |█████████████████---| 89.0%  - val_loss: 1952.5909423828 - val_trvae_loss: 1952.5907796224 - val_landmark_loss: 0.0001483189 - val_unlabeled_loss: 0.1483189298 |██████████████████--| 90.0%  - val_loss: 1952.3907470703 - val_trvae_loss: 1952.3906250000 - val_landmark_loss: 0.0001402005 - val_unlabeled_loss: 0.1402004999 |██████████████████--| 91.0%  - val_loss: 1932.3482530382 - val_trvae_loss: 1932.3481038411 - val_landmark_loss: 0.0001494243 - val_unlabeled_loss: 0.1494243393 |██████████████████--| 92.0%  - val_loss: 1934.8559434679 - val_trvae_loss: 1934.8557942708 - val_landmark_loss: 0.0001399978 - val_unlabeled_loss: 0.1399977654 |██████████████████--| 93.0%  - val_loss: 1930.6994086372 - val_trvae_loss: 1930.6992730035 - val_landmark_loss: 0.0001339702 - val_unlabeled_loss: 0.1339702391 |██████████████████--| 94.0%  - val_loss: 1946.4922688802 - val_trvae_loss: 1946.4921332465 - val_landmark_loss: 0.0001488811 - val_unlabeled_loss: 0.1488811258 |███████████████████-| 95.0%  - val_loss: 1950.6688639323 - val_trvae_loss: 1950.6687147352 - val_landmark_loss: 0.0001517122 - val_unlabeled_loss: 0.1517122305 |███████████████████-| 96.0%  - val_loss: 1958.1485324436 - val_trvae_loss: 1958.1483696832 - val_landmark_loss: 0.0001473937 - val_unlabeled_loss: 0.1473936588 |███████████████████-| 97.0%  - val_loss: 1941.6046413845 - val_trvae_loss: 1941.6045057509 - val_landmark_loss: 0.0001417740 - val_unlabeled_loss: 0.1417740070 |███████████████████-| 98.0%  - val_loss: 1950.7758517795 - val_trvae_loss: 1950.7757297092 - val_landmark_loss: 0.0001344951 - val_unlabeled_loss: 0.1344951044 |███████████████████-| 99.0%  - val_loss: 1943.9071994358 - val_trvae_loss: 1943.9070366753 - val_landmark_loss: 0.0001431254 - val_unlabeled_loss: 0.1431253685 |████████████████████| 100.0%  - val_loss: 1944.3639865451 - val_trvae_loss: 1944.3638373481 - val_landmark_loss: 0.0001371668 - val_unlabeled_loss: 0.1371668271
/home/icb/carlo.dedonno/anaconda3/envs/lataq_cuda/lib/python3.8/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y, hue. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(
2021-10-26 15:20:29 (INFO): Computing metrics
2021-10-26 15:20:30 (INFO): Compute integration metrics
... storing 'study' as categorical
... storing 'cell_type' as categorical
2021-10-26 15:33:45 (INFO): Result: {'distances':   condition      dist
0    Oetjen  0.373654
1       Sun  1.230060
2   Freytag  1.230060
3       10X  0.373654, 'classification_report':                                   precision    recall  f1-score       support
CD10+ B cells                      0.990431  1.000000  0.995192    207.000000
CD14+ Monocytes                    0.991309  0.971758  0.981436   6338.000000
CD16+ Monocytes                    0.910936  0.979394  0.943925    825.000000
CD20+ B cells                      0.998232  0.982597  0.990353   2873.000000
CD4+ T cells                       0.974756  0.760966  0.854695  11011.000000
CD8+ T cells                       0.448245  0.930371  0.605004   2183.000000
Erythrocytes                       0.965444  0.911451  0.937671   1502.000000
Erythroid progenitors              0.705305  0.775378  0.738683    463.000000
HSPCs                              0.978448  0.959831  0.969050    473.000000
Megakaryocyte progenitors          0.736364  0.900000  0.810000    270.000000
Monocyte progenitors               0.865424  0.976636  0.917673    428.000000
Monocyte-derived dendritic cells   0.927835  0.941423  0.934579    478.000000
NK cells                           0.973643  0.805144  0.881413   2294.000000
NKT cells                          0.806541  0.952277  0.873371   2745.000000
Plasma cells                       0.976562  0.968992  0.972763    129.000000
Plasmacytoid dendritic cells       0.992453  0.992453  0.992453    265.000000
accuracy                           0.878863  0.878863  0.878863      0.878863
macro avg                          0.890120  0.925542  0.899891  32484.000000
weighted avg                       0.920687  0.878863  0.888343  32484.000000, 'classification_report_query':                                   precision    recall  f1-score       support
CD14+ Monocytes                    0.987153  0.975207  0.981143   3388.000000
CD16+ Monocytes                    0.818396  0.953297  0.880711    364.000000
CD20+ B cells                      0.997356  0.976067  0.986597   1546.000000
CD4+ T cells                       0.977797  0.779707  0.867589   2937.000000
CD8+ T cells                       0.362409  0.997143  0.531607    350.000000
HSPCs                              1.000000  0.607143  0.755556     28.000000
Megakaryocyte progenitors          0.525000  1.000000  0.688525     21.000000
Monocyte-derived dendritic cells   0.981132  0.857143  0.914956    182.000000
NK cells                           0.992982  0.748677  0.853695    756.000000
NKT cells                          0.781225  0.929924  0.849114   1056.000000
Plasma cells                       1.000000  0.777778  0.875000     18.000000
Plasmacytoid dendritic cells       1.000000  1.000000  1.000000     81.000000
accuracy                           0.898294  0.898294  0.898294      0.898294
macro avg                          0.868621  0.883507  0.848708  10727.000000
weighted avg                       0.939235  0.898294  0.908463  10727.000000, 'integration_scores':    NMI_cluster/label  ARI_cluster/label  ...  isolated_label_silhouette  graph_conn
0           0.863135           0.858836  ...                    0.58483    0.992724

[1 rows x 8 columns]}
2021-10-26 15:33:45 (INFO): Completed after 0:17:36
Saving best state of network...
Best State was in Epoch 87
NMI...
ARI...
Silhouette score...
PC regression...
Isolated labels F1...
Isolated labels ASW...
Graph connectivity...
